SELECT products.product_name, SUM(sales.sales_price) - SUM(purchases.cost_price)AS profit
 FROM sales,purchases,products 
 GROUP BY products.product_name 
ORDER BY profit DESC;